<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="widthdevice-width, initial-scale=1">
    <link rel="icon" href="white_logo.png" type="image/x-icon">
    <title>HACCP Training Preference Form</title>  
    <link rel="stylesheet" href="style.css" />
    <script>
      window.onload=getstatus();
       function getstatus(){
   const url = "https://script.google.com/macros/s/AKfycbxR9JjLW-_xKlNmW7-2OmoqYeHLkfZn45DJL-kazZ4Nl_gGqbUNwJk96DmvpyGzxAPp/exec" 
   var val = "HACCP Training Preference Form";
   console.log(val)
   fetch(`${url}?header=${val}`)
       .then((response) => response.json())
       .then(({ data }) => {
           if (data == "Live"){
   
               document.getElementById("frqa").style.display="initial";
               document.getElementById("ll").textContent="";
   
               }
               else if (data == "Inactive"){
                 document.getElementById("frqa").style.display="none";
                 window.location='end.html';
               }
       })
       .catch((error) => console.error('!!!!!!!!', error));
   }
   setInterval(() => {
    getstatus();
}, 1000);
   </script>
</head>    
<body>
<section class="header">
<div>
<img src="white_logo.png" alt="">
</div>
<div>
<h1>NIFTEM-T Placement Cell</h1>
</div>
</section>
<section >
<div class="form-container">
<script type="text/javascript">var submitted=false </script>
<iframe name="hiddenConfirm" id="hiddenConfirm" style="display: none;" onload="if(submitted){
    window.location='submifssion.html'; }"></iframe>
    <form id="form" class="container m-4 pl-4" method="POST">
<h1 style="text-align: center;"> HACCP Training Preference Form </h1>
<h3 id="ll" style="text-align: center;">Form Loading....</h3>

<div id="frqa" class="frqa">
<div class="form-element">
<span class="q">Name</span>
<select name="Name" id="Name" required placeholder="Select your name">
<option value="">Select your name</option>
<option value='Aarthi A'>Aarthi A</option>
<option value='Aishwarya Lakshmi S'>Aishwarya Lakshmi S</option>
<option value='Ajitesh S'>Ajitesh S</option>
<option value='Akash B'>Akash B</option>
<option value='Amirtha Varshini A'>Amirtha Varshini A</option>
<option value='Anandha Keerthy M'>Anandha Keerthy M</option>
<option value='Anindit Bizy Nair'>Anindit Bizy Nair</option>
<option value='Anusha R'>Anusha R</option>
<option value='Archana P'>Archana P</option>
<option value='Avantika C'>Avantika C</option>
<option value='Chandrika Devendrappa'>Chandrika Devendrappa</option>
<option value='Chitturi Rohith'>Chitturi Rohith</option>
<option value='Cubarani Η'>Cubarani Η</option>
<option value='David Evander Jebson S'>David Evander Jebson S</option>
<option value='Dhanaselvam KR'>Dhanaselvam KR</option>
<option value='Diana Celcia R'>Diana Celcia R</option>
<option value='Diya Dharshini S'>Diya Dharshini S</option>
<option value='Ethaya D'>Ethaya D</option>
<option value='Gautam Nayak'>Gautam Nayak</option>
<option value='Ginu Robtus R'>Ginu Robtus R</option>
<option value='Guberavishnu S'>Guberavishnu S</option>
<option value='Guguloth Sridhar'>Guguloth Sridhar</option>
<option value='Himavanth R'>Himavanth R</option>
<option value='Jegan P'>Jegan P</option>
<option value='Jenish Daniel B'>Jenish Daniel B</option>
<option value='Joshua Charles'>Joshua Charles</option>
<option value='K Kabilan'>K Kabilan</option>
<option value='Karyamsetty Worship'>Karyamsetty Worship</option>
<option value='Keerthika P'>Keerthika P</option>
<option value='Kevin Francis'>Kevin Francis</option>
<option value='Kisha M'>Kisha M</option>
<option value='Kota Lakshmi Sanjana'>Kota Lakshmi Sanjana</option>
<option value='Lakshmi Narayanan S'>Lakshmi Narayanan S</option>
<option value='Lakshmi Sruthi L'>Lakshmi Sruthi L</option>
<option value='Lavudya Sai Kumar'>Lavudya Sai Kumar</option>
<option value='Mahabir Prasad Swain'>Mahabir Prasad Swain</option>
<option value='Merla A P'>Merla A P</option>
<option value='Mohamed Tharif N J'>Mohamed Tharif N J</option>
<option value='Mohannath Shroff J'>Mohannath Shroff J</option>
<option value='MA Monesh Ram'>MA Monesh Ram</option>
<option value='Mudavath Anjali'>Mudavath Anjali</option>
<option value='Muthuraja K'>Muthuraja K</option>
<option value='Nitheesh R L'>Nitheesh R L</option>
<option value='Nithish J P'>Nithish J P</option>
<option value='Padmaja M'>Padmaja M</option>
<option value='Pranav Nanda Kishore'>Pranav Nanda Kishore</option>
<option value='Punithavathi D'>Punithavathi D</option>
<option value='Rakshithapriya S'>Rakshithapriya S</option>
<option value='J Sanjeeth'>J Sanjeeth</option>
<option value='Santhoshkumar P'>Santhoshkumar P</option>
<option value='Shivam Jha'>Shivam Jha</option>
<option value='Sivashree '>Sivashree </option>
<option value='Sri Harini S'>Sri Harini S</option>
<option value='Srinithi C P'>Srinithi C P</option>
<option value='Srivatsan V'>Srivatsan V</option>
<option value='Subbu Krishna Sharma GM '>Subbu Krishna Sharma GM </option>
<option value='Suman Kumar'>Suman Kumar</option>
<option value='Surendar S'>Surendar S</option>
<option value='Tippaleti Srujana'>Tippaleti Srujana</option>
<option value='Vemula Uharika'>Vemula Uharika</option>
<option value='Vishnu Varthan T'>Vishnu Varthan T</option>
<option value='Yadla Ganesh Babu'>Yadla Ganesh Babu</option>
<option value='Yuvashreekantham R'>Yuvashreekantham R</option>
</select>

</div>
<div class="form-element radio-buttons">


<label for="Preferred for HACCP Training and aware of training fee structure">
<input
required
type="checkbox"
name="Preference Declaration"
class="Preference Declaration"
id="Preferred for HACCP Training and aware of training fee structure"
value="I hereby give my preference for HACCP Training and I am aware of training fee structure"
/>
<span>I hereby give my preference for HACCP Training and I am aware of training fee structure</span>
</label>
</div>

<button style="margin-top: 20px;" type="submit" id="bt"> 
Submit
</button> 
</div>
<div id="load" class="load" > 
  <div class="loader" id="loader"> 

    </div> 
    <div
      id="message"
    class="message"
      ></div>
  </div> 
  </div> 
</div>
<script>
  let form = document.querySelector("form");
form.addEventListener('submit',()=>{ {
  document.getElementById("load").style.display="initial";
  document.getElementById("loader").style.display="block"; 
  document.getElementById("bt").style.display="none";
}})
  
document.getElementById("form").addEventListener("submit", function (e) {
        e.preventDefault(); // Prevent the default form submission
        document.getElementById("message").textContent = "Submitting..";
        document.getElementById("message").style.display = "block";
        document.getElementById("bt").disabled = true;

        // Collect the form data
        var formData = new FormData(this);
        var keyValuePairs = [];
        for (var pair of formData.entries()) { 
     
          if (pair[0] !== "file"){
            
          
          keyValuePairs.push(pair[0] + "=val=" + pair[1]);
console.log(pair[0])
        }}

        var formDataString = keyValuePairs.join("=namff=");
console.log(formDataString)

        // Send a POST request to your Google Apps Script
        fetch(
          "https://script.google.com/macros/s/AKfycbzFnI9s5ldyJS4_v_FniF11n2fDBHEhUDeZbfqCLSE4xBCL8MpAzQ-SaOcTewVtsG2R/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formDataString,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(function (response) {

            // Check if the request was successful
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to submit the form.");
            }
          })
          .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
            if (result1.data2 == "accept"){
            // Display a success message
            document.getElementById("bt").disabled = false;
            document.getElementById("form").reset();
            window.location='submission.html';
            setTimeout(function () {
              document.getElementById("message").textContent = "";
              document.getElementById("message").style.display = "none";
            }, 2600);}
            else if (result1.data2 == "reject"){
              window.location='reject.html';
            }
          })

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while submitting the form.";
            document.getElementById("message").style.display = "block";
          });
      });



      function refreshwin(){
        console.log("ok")
        window.location = window.location.href;
      }


</script>
<script src="script.js  "></script>

</section>
</body>
</html>